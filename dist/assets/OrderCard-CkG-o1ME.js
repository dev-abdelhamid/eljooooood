import{c as I,r as h,u as S,j as e,m,C as v,a as L,A as O,L as z,B as d,b as $,d as o,P as w,T as E}from"./index-D6qGjsdI.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],U=I("chevron-up",P),N={pending:{color:"bg-yellow-100 text-yellow-800",icon:$,label:"pending",progress:0},approved:{color:"bg-teal-100 text-teal-800",icon:o,label:"approved",progress:25},in_production:{color:"bg-purple-100 text-purple-800",icon:w,label:"in_production",progress:50},completed:{color:"bg-green-100 text-green-800",icon:o,label:"completed",progress:75},in_transit:{color:"bg-blue-100 text-blue-800",icon:E,label:"in_transit",progress:90},delivered:{color:"bg-gray-100 text-gray-800",icon:o,label:"delivered",progress:100},cancelled:{color:"bg-red-100 text-red-800",icon:v,label:"cancelled",progress:0}},f={pending:{label:"pending",color:"bg-gray-50 text-gray-600",icon:$},assigned:{label:"assigned",color:"bg-blue-50 text-blue-600",icon:o},in_progress:{label:"in_progress",color:"bg-yellow-50 text-yellow-600",icon:w},completed:{label:"completed",color:"bg-green-50 text-green-600",icon:o}},q={low:"bg-gray-100 text-gray-700",medium:"bg-blue-100 text-blue-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"},D=h.memo(({order:a,updateOrderStatus:p,openAssignModal:C,calculateAdjustedTotal:_,calculateTotalQuantity:b,translateUnit:g,submitting:r,isRtl:s})=>{var y;const{user:l}=S(),[u,k]=h.useState(!1),c=N[a.status]||N.pending,T=c.icon,x=a.items.filter(t=>!t.assignedTo),A=h.useCallback(()=>{k(t=>!t)},[]);return e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"mb-4",role:"region","aria-labelledby":`order-${a.id}`,children:e.jsx("div",{className:"p-3 bg-white shadow-md rounded-lg border border-gray-200 hover:shadow-lg transition-shadow duration-300",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:`flex items-center justify-between ${s?"flex-row":""}`,children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("h3",{id:`order-${a.id}`,className:"text-base font-semibold text-gray-800 truncate max-w-[220px]",children:s?`طلب ${a.orderNumber||"غير معروف"}`:`Order #${a.orderNumber||"Unknown"}`}),a.priority!=="medium"&&e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs font-medium ${q[a.priority]} ${s?"mr-1":"ml-1"}`,children:s?{urgent:"عاجل",high:"مرتفع",medium:"متوسط",low:"منخفض"}[a.priority]:a.priority})]}),e.jsxs("span",{className:`px-1.5 py-0.5 rounded-full text-xs font-medium flex items-center gap-1 ${c.color} ${s?"flex-row-reverse":""}`,children:[e.jsx(T,{className:"w-3 h-3"}),s?{pending:"قيد الانتظار",approved:"تم الموافقة",in_production:"في الإنتاج",completed:"مكتمل",in_transit:"في النقل",delivered:"تم التسليم",cancelled:"ملغى"}[a.status]:c.label]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-amber-600 h-1.5 rounded-full transition-all duration-500",style:{width:`${c.progress}%`}})}),x.length>0&&e.jsxs(m.div,{initial:{opacity:0},animate:{opacity:1},className:"p-1.5 bg-yellow-50 border border-yellow-100 rounded-md flex items-center gap-1.5",role:"alert",children:[e.jsx(v,{className:"w-3 h-3 text-yellow-600"}),e.jsx("span",{className:"text-xs text-yellow-600",children:s?`${x.length} عناصر غير معينة`:`${x.length} unassigned items`})]}),e.jsxs("div",{className:"grid  grid-cols-2 sm:grid-cols-4 gap-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:s?"الكمية الإجمالية":"Total Quantity"}),e.jsx("p",{className:"text-xs font-medium text-gray-800",children:s?`${b(a)} عنصر`:`${b(a)} items`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:s?"إجمالي المبلغ":"Total Amount"}),e.jsx("p",{className:"text-xs  font-semibold text-teal-600",children:_(a)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:s?"التاريخ":"Date"}),e.jsx("p",{className:"text-xs font-medium text-gray-800 truncate",children:a.date})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:s?"الفرع":"Branch"}),e.jsx("p",{className:"text-xs font-medium text-gray-800 truncate",children:a.branchName})]})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:A,className:"flex items-center justify-between w-full p-2 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors duration-200","aria-expanded":u,"aria-controls":`items-${a.id}`,children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-900",children:s?"المنتجات":"Products"}),u?e.jsx(U,{className:"w-4 h-4 text-gray-600"}):e.jsx(L,{className:"w-4 h-4 text-gray-600"})]}),e.jsx(O,{children:u&&e.jsx(m.div,{id:`items-${a.id}`,initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:e.jsx("div",{className:"space-y-2 mt-2",children:a.items.map(t=>{var n,j;const i=f[t.status]||f.pending;return i.icon,e.jsxs(m.div,{initial:{opacity:0,x:s?20:-20},animate:{opacity:1,x:0},transition:{duration:.2},className:"p-2 bg-gray-50 rounded-md",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("p",{className:"text-xs font-medium text-gray-900 truncate flex-1",children:[t.productName," (",t.quantity," ",g(t.unit,s),")"]}),e.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-xs font-small flex items-center gap-1 ${i.color} ${s?"flex-row-reverse":""}`,children:s?{pending:"قيد الانتظار",assigned:"معين",in_progress:"قيد التقدم",completed:"مكتمل"}[t.status]:i.label})]}),e.jsx("div",{className:"flex items-center justify-between gap-2 mt-1",children:t.assignedTo&&e.jsx("p",{className:"text-xs text-gray-600 truncate",children:s?`معين لـ: شيف ${t.assignedTo.name} (${((n=t.department)==null?void 0:n.name)||"Unknown"})`:`Assigned to: Chef ${t.assignedTo.name} (${((j=t.department)==null?void 0:j.name)||"Unknown"})`})})]},t._id)})})})})]}),a.notes&&e.jsx("div",{className:"mt-1 p-1.5 bg-amber-50 rounded-md",children:e.jsxs("p",{className:"text-xs text-amber-800 truncate",children:[e.jsx("strong",{children:s?"ملاحظات:":"Notes:"})," ",a.notes]})}),((y=a.returns)==null?void 0:y.length)>0&&e.jsxs("div",{className:"mt-1 p-1.5 bg-amber-50 rounded-md",children:[e.jsx("p",{className:"text-xs font-medium text-amber-800",children:s?"الإرجاعات":"Returns"}),a.returns.map((t,i)=>e.jsx("p",{className:"text-xs text-amber-700 truncate",children:s?`${t.items.map(n=>`${n.quantity} ${g(n.unit,s)} ${n.reason}`).join(", ")} - الحالة: ${s?{pending:"قيد الانتظار",approved:"تمت الموافقة",rejected:"مرفوض",processed:"تمت المعالجة"}[t.status]:t.status}`:`${t.items.map(n=>`${n.quantity} ${g(n.unit,s)} ${n.reason}`).join(", ")} - Status: ${t.status}`},i))]}),e.jsxs("div",{className:`flex flex-wrap gap-1.5 ${s?"justify-end":"justify-start"}`,children:[e.jsx(z,{to:`/orders/${a.id}`,children:e.jsx(d,{variant:"primary",size:"sm",className:"bg-blue-500 hover:bg-blue-600 text-white rounded-full px-2.5 py-1 text-xs","aria-label":s?`عرض طلب رقم ${a.orderNumber}`:`View order #${a.orderNumber}`,children:s?"عرض":"View"})}),(l==null?void 0:l.role)==="production"&&a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{variant:"success",size:"sm",onClick:()=>p(a.id,"approved"),className:"bg-green-500 hover:bg-green-600 text-white rounded-full px-2.5 py-1 text-xs",disabled:r===a.id,"aria-label":s?`الموافقة على طلب رقم ${a.orderNumber}`:`Approve order #${a.orderNumber}`,children:r===a.id?s?"جارٍ الموافقة...":"Loading...":s?"موافقة":"Approve"}),e.jsx(d,{variant:"danger",size:"sm",onClick:()=>p(a.id,"cancelled"),className:"bg-red-500 hover:bg-red-600 text-white rounded-full px-2.5 py-1 text-xs",disabled:r===a.id,"aria-label":s?`إلغاء طلب رقم ${a.orderNumber}`:`Cancel order #${a.orderNumber}`,children:r===a.id?s?"جارٍ الإلغاء...":"Loading...":s?"إلغاء":"Cancel"})]}),(l==null?void 0:l.role)==="production"&&a.status==="approved"&&x.length>0&&e.jsx(d,{variant:"primary",size:"sm",onClick:()=>C(a),className:"bg-blue-500 hover:bg-blue-600 text-white rounded-full px-2.5 py-1 text-xs",disabled:r===a.id,"aria-label":s?`تعيين طلب رقم ${a.orderNumber}`:`Assign order #${a.orderNumber}`,children:r===a.id?s?"جارٍ التوزيع...":"Loading...":s?"توزيع":"Assign"}),(l==null?void 0:l.role)==="production"&&a.status==="completed"&&e.jsx(d,{variant:"primary",size:"sm",onClick:()=>p(a.id,"in_transit"),className:"bg-blue-500 hover:bg-blue-600 text-white rounded-full px-2.5 py-1 text-xs",disabled:r===a.id,"aria-label":s?`شحن طلب رقم ${a.orderNumber}`:`Ship order #${a.orderNumber}`,children:r===a.id?s?"جارٍ الشحن...":"Loading...":s?"شحن":"Ship"})]})]})})})});export{D as default};
