import{e as N,r as f,j as i,M as w,m as y,S as _,C as T,B as v}from"./index-OixFsMgm.js";const M=({isOpen:C,onClose:h,selectedOrder:n,assignFormData:p,chefs:g,error:c,submitting:x,assignChefs:$,setAssignForm:r,isRtl:e})=>{N();const d=f.useMemo(()=>{const s=new Map;return g.forEach(t=>{var a;(a=t.department)!=null&&a._id&&(s.has(t.department._id)||s.set(t.department._id,[]),s.get(t.department._id).push(t))}),s},[g]),j=(s,t)=>{r({items:p.items.map((a,o)=>o===s?{...a,assignedTo:t}:a)})};return f.useEffect(()=>{if(!n)return;const s=p.items.map(a=>{const o=n.items.find(m=>m._id===a.itemId),l=(o==null?void 0:o.department._id)||"",u=d.get(l)||[];return a.assignedTo===""&&u.length===1?{...a,assignedTo:u[0].userId}:a});s.some((a,o)=>a.assignedTo!==p.items[o].assignedTo)&&r({items:s})},[p.items,d,n,r]),i.jsx(w,{isOpen:C,onClose:h,title:e?`تعيين الشيفات لطلب ${n==null?void 0:n.orderNumber}`:`Assign Chefs to Order #${n==null?void 0:n.orderNumber}`,size:"md",className:"bg-white rounded-lg shadow-xl border border-gray-100",children:i.jsxs("form",{onSubmit:s=>{s.preventDefault(),$((n==null?void 0:n.id)||"")},className:"space-y-6",children:[p.items.map((s,t)=>{const a=n==null?void 0:n.items.find(m=>m._id===s.itemId),o=(a==null?void 0:a.department._id)||"",l=d.get(o)||[],u=[{value:"",label:e?"اختر شيف":"Select Chef"},...l.map(m=>{var b;return{value:m.userId,label:`${m.name} (${((b=m.department)==null?void 0:b.name)||(e?"غير معروف":"Unknown")})`}})];return i.jsxs(y.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,delay:t*.1},children:[i.jsx("label",{className:`block text-sm font-medium text-gray-900 mb-1 ${e?"text-right":"text-left"}`,htmlFor:`chef-select-${t}`,children:e?`تعيين شيف لـ ${a==null?void 0:a.productName} (${s.quantity} ${s.unit})`:`Assign chef to ${a==null?void 0:a.productName} (${s.quantity} ${s.unit})`}),i.jsx(_,{id:`chef-select-${t}`,options:u,value:s.assignedTo,onChange:m=>j(t,m),className:"w-full rounded-md border-gray-200 focus:ring-amber-500 text-sm shadow-sm","aria-label":e?"اختر شيف":"Select Chef"})]},t)}),c&&i.jsxs(y.div,{initial:{opacity:0},animate:{opacity:1},className:`p-3 bg-red-50 border border-red-200 rounded-md flex items-center gap-2 ${e?"flex-row-reverse":""}`,children:[i.jsx(T,{className:"w-5 h-5 text-red-600"}),i.jsx("span",{className:"text-red-600 text-sm",children:c})]}),i.jsxs("div",{className:`flex justify-end gap-2 ${e?"flex-row-reverse":""}`,children:[i.jsx(v,{variant:"secondary",onClick:h,className:"bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-md px-4 py-2 text-sm shadow-sm","aria-label":e?"إلغاء":"Cancel",children:e?"إلغاء":"Cancel"}),i.jsx(v,{type:"submit",variant:"primary",disabled:x!==null,className:"bg-amber-500 hover:bg-amber-600 text-white rounded-md px-4 py-2 text-sm shadow-sm","aria-label":e?"تعيين الشيفات":"Assign Chefs",children:x?e?"جارٍ التحميل":"Loading":e?"تعيين الشيفات":"Assign Chefs"})]})]})})};export{M as AssignChefsModal,M as default};
